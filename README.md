# CMT-CNN-for-COVID-19-diagnosis
Multi-task Contrastive Learning for Automatic CT and X-ray Diagnosis of COVID-19

This work has been submitted to peer review for possible publication. Here, we post the data resources, and are currently arranging and optimizing the code, which will be made public soon.

Abstract: Computed tomography (CT) and X-ray are effective methods for diagnosing COVID-19. Although several studies have demonstrated the potential of deep leaning in the automatic diagnosis of COVID-19 using CT or X-ray, the generalization on unseen samples needs to be improved. To tackle this problem, we present contrastive multi-task convolutional neural network (CMT-CNN), which is composed of two tasks. The main task is to diagnose COVID-19 from other pneumonia and normal control. The auxiliary task is to encourage local aggregation though contrastive learning: first, each image is transformed by a series of augmentations (Poisson noise, rotation, etc.). Then, the model is optimized to embed representations of a same image similar while different images dissimilar in a latent space. In this way, CMT-CNN is capable of making transformation invariant predictions and the spread-out properties of data are preserved. We demonstrate that the apparently simple auxiliary task provides powerful supervisions to enhance generalization. We conduct experiments on a CT dataset (4,758 samples) and an X-ray dataset (5,821 samples) assembled by open datasets and data collected in our hospital. Experimental results demonstrate that contrastive learning (as plugin module) brings solid accuracy improvement for deep learning models on both the CT dataset (5.49%-6.45%) and the X-ray dataset (0.96%-2.42%) without requiring additional annotations. Our codes are accessible online.

The links of the open X-ray datasets are in the paper, and the X-ray images collected at our hospital are in the file 'X-ray'.
